--- BigQuery Audit Logs
-- resource.type=("bigquery_dataset" OR "bigquery_project")
-- logName:"cloudaudit.googleapis.com"

--- BigQuery Dataset Audit Logs
-- resource.type="bigquery_dataset" AND
-- logName:"cloudaudit.googleapis.com"

--- BigQuery Dataset Updates
-- resource.type="bigquery_dataset" AND
-- log_id("cloudaudit.googleapis.com/activity") AND
-- protoPayload.methodName="google.cloud.bigquery.v2.DatasetService.UpdateDataset"

--- BigQuery Jobs Completed
-- resource.type="bigquery_project" AND
-- log_id("cloudaudit.googleapis.com/data_access") AND
-- protoPayload.methodName=("google.cloud.bigquery.v2.JobService.InsertJob"
-- OR "google.cloud.bigquery.v2.JobService.Query")

---
-- resource.type="bigquery_project" AND
-- protoPayload.metadata.jobInsertion.reason:*


-- resource.type="gcs_bucket" AND
-- logName:"cloudaudit.googleapis.com"

--- Updates
resource.type=("bigquery_dataset" OR "bigquery_project") AND
logName:"cloudaudit.googleapis.com" AND
protoPayload.resourceName: ("projects/relax-melodies-android/datasets/ua_dashboard_prod" OR "projects/relax-melodies-android/datasets/ua_extract_prod" OR "projects/relax-melodies-android/datasets/ua_transform_prod") AND
protoPayload.methodName = "google.cloud.bigquery.v2.TableService.UpdateTable"

--- Test relax server
logName: "projects/relax-server/logs/cloudfunctions.googleapis.com" AND
resource.labels.function_name = "recommendation" AND
resource.labels.project_id = "relax-server" AND
resource.type = "cloud_function" AND
severity = "INFO"

/* protoPayload.authenticationInfo.principalEmail = ("example@gmail.com" OR "example2@gmail.com") */

/* protoPayload.resourceName="projects/relax-melodies-android/datasets/ua_extract_dev/tables/FacebookWebAds" */

/* protoPayload.metadata.methodName = "google.cloud.bigquery.v2.TableService" */ -- doesn't work
